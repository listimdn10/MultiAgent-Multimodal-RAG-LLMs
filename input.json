{
  "code": "pragma solidity ^0.4.15;\n\n//Auction susceptible to DoS attack\ncontract DosAuction {\n  address currentFrontrunner;\n  uint currentBid;\n\n  //Takes in bid, refunding the frontrunner if they are outbid\n  function bid() payable {\n    require(msg.value > currentBid);\n\n    //If the refund fails, the entire transaction reverts.\n    //Therefore a frontrunner who always fails will win\n    if (currentFrontrunner != 0) {\n      //E.g. if recipients fallback function is just revert()\n      // <yes> <report> DENIAL_OF_SERVICE\n      require(currentFrontrunner.send(currentBid));\n    }\n\n    currentFrontrunner = msg.sender;\n    currentBid         = msg.value;\n  }\n}",
  "functional_semantic": "Abstract purpose: The contract defines an intentionally vulnerable auction mechanism where the requirement for a successful refund allows a malicious previous bidder to execute a denial-of-service attack against all subsequent higher bids.\n\nDetail Behaviors:\n1. Tracks the address of the current highest bidder.\n2. Tracks the amount of the current highest bid.\n3. Accepts new bids only if they are strictly greater than the current bid amount.\n4. Attempts to refund the previous highest bid to the previous frontrunner address.\n5. Requires the refund transaction to succeed for the new bid transaction to complete.\n6. Updates the current frontrunner and bid amount if the transaction, including the refund, is successful."
}