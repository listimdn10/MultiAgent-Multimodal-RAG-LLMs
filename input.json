{
  "code": "pragma solidity ^0.4.15;\n\n//Auction susceptible to DoS attack\ncontract DosAuction {\n  address currentFrontrunner;\n  uint currentBid;\n\n  //Takes in bid, refunding the frontrunner if they are outbid\n  function bid() payable {\n    require(msg.value > currentBid);\n\n    //If the refund fails, the entire transaction reverts.\n    //Therefore a frontrunner who always fails will win\n    if (currentFrontrunner != 0) {\n      //E.g. if recipients fallback function is just revert()\n      // <yes> <report> DENIAL_OF_SERVICE\n      require(currentFrontrunner.send(currentBid));\n    }\n\n    currentFrontrunner = msg.sender;\n    currentBid         = msg.value;\n  }\n}",
  "functional_semantic": "Abstract purpose: This Solidity contract implements a basic bidding system where the previous bidder is refunded, demonstrating a Denial of Service vulnerability because a failure in the refund process permanently freezes the auction.\n\nDetail Behaviors:\n1. Defines state variables to track the address of the current frontrunner and the amount of the current highest bid.\n2. Allows users to submit bids using a payable function.\n3. Requires any new submitted bid value to be greater than the current bid.\n4. Attempts to refund the previous frontrunner their bid amount if one exists.\n5. Reverts the entire transaction if the refund attempt to the previous frontrunner fails.\n6. Updates the current frontrunner and the current bid amount upon a successful transaction."
}